<?xml version="1.0" encoding="UTF-8"?>
<project name="CJD" basedir="." default="install">
	
	<property name="maven" value="C:\Documents and Settings\Howard Green\Desktop\Libraries\apache-maven-2.2.1\bin\mvn.bat" />
	<property name="pom" value="pom.xml"/>
	
	<property name="version" value="0.0.2-SNAPSHOT" />

	<property name="src.dir" value="src" />
	<property name="gen.dir" value="gen" />
	<property name="classes.dir" value="classes" />
	<property name="dest.dir" value="bin" />

	<property name="cjd-doc.jar" value="cjd-doc-${version}.jar" />
    <property name="cjd.jar" value="cjd-${version}.jar" />

	<target name="cjd-doc-jar">
		<jar destfile="${cjd-doc.jar}" index="true">
			<fileset dir="${classes.dir}"
			         includes="cjd/**" />
			<fileset dir="${module.dir}" includes="*.gwt.rpc" />
		</jar>
	</target>
	
	<target name="version-file">
		<concat destfile="${gen.dir}/clojure/cjd/version.clj">;; Auto-generated from build.xml -- do not update!
#_(* Auto-generated CJD version string. See build.xml to update.)
(ns cjd.version)
#_(* CJD version string. )
(def *cjd-version* "${version}")
		</concat>
	</target>

	<target name="cjd-jar" depends="version-file">
		<jar destfile="${dest.dir}/${cjd.jar}" index="true">
			<manifest>
				<attribute name="Main-Class" value="cjd.main"/>
			</manifest>	
			<fileset dir="${classes.dir}" includes="cjd/**" />
			<fileset dir="${classes.dir}" includes="leiningen/**" />
			<fileset dir="${classes.dir}" includes="clojure/**" />
		</jar>
	</target>

	<target name="install" depends="cjd-jar">
		<exec executable="${maven}">
			<arg value="install:install-file"/>
			<arg value="-Dfile=${dest.dir}/${cjd.jar}"/>
			<arg value="-DpomFile=${pom}"/>
		</exec>
	
	</target>
	
</project>

			<!--arg value="-DartifactId=cjd"/>
			<arg value="-DgroupId=cjd"/>
			<arg value="-Dpackaging=jar"/>
			<arg value="-DgeneratePom=true"/>
			<arg value="-Dversion=${version}"/-->
