<!DOCTYPE html>
<html><head><meta charset="ISO-8859-1"><title>CJD &ndash; cjd.exome</title><link href="cjd.css" rel="stylesheet" type="text/css" /><link href="extensomatic.css" rel="stylesheet" type="text/css" /></head><body><div id="top"></div><div class="leader"><table><tbody><tr><td width="100%"><td align="right"><a href="index.html"><span class="headlink">Index</span></a></td></tr></tbody></table></div><div class="ns">cjd.exome</div><div class="desc"><p>Top-level driver routines for the CJD documentation generation process.</p></div><div class="desc"><table class="summary"><tbody><tr><td colspan="2"><p class="sum-hdr">Function/Macro Summary</p></td></tr><tr class="sum"><td><a href="#cjd-gen">cjd&#8209;gen</a></td><td><div class="blurb"><a href="cjd.util.defnk.html#defnk">defnk</a>-based alternate front-end for <a href="#cjd-generator">cjd-generator</a>, intended for easy REPL invocation. </div></td></tr><tr class="sum"><td><a href="#cjd-generator">cjd&#8209;generator</a></td><td><div class="blurb">Main CJD document processing driver. </div></td></tr><tr class="sum"><td><a href="#cjd-read">cjd&#8209;read</a></td><td><div class="blurb">Reads the next form from the specified input reader. </div></td></tr><tr class="sum"><td><a href="#endoculate">endoculate</a></td><td><div class="blurb">Accepts a sequence of Clojure forms from some source, and motivates a parsing exercise on them, to result in a rough abstract syntax tree that serves as the basis for further processing. </div></td></tr><tr class="sum"><td><a href="#excluded-file">excluded&#8209;file</a></td><td><div class="blurb">Determines if a file should be excluded from processing. </div></td></tr><tr class="sum"><td><a href="#find-files">find&#8209;files</a></td><td><div class="blurb">Starting from a collection of file objects, checks to see if each file is directly of interest (e.g., is readable, ends with &quot;.clj&quot;, isn't excluded), or if it's a directory, in which case its contents are recursively analyzed. </div></td></tr><tr class="sum"><td><a href="#find-item">find&#8209;item</a></td><td><div class="blurb">Tries to find an item (such as a function) that's identified in any of several ways. </div></td></tr><tr class="sum"><td><a href="#forms-from-file">forms&#8209;from&#8209;file</a></td><td><div class="blurb">Repetitively reads a Clojure file using <a href="#cjd-read">cjd-read</a>, and returns a sequence of the forms contained therein. </div></td></tr><tr class="sum"><td><a href="#forms-from-string">forms&#8209;from&#8209;string</a></td><td><div class="blurb">Repetitively reads from a string using <a href="#cjd-read">cjd-read</a>, and returns a sequence of the forms contained therein. This is intended primarily as a debugging tool. </div></td></tr><tr class="sum"><td><a href="#massage">massage</a></td><td><div class="blurb">&quot;Massages&quot; identifiers for things like the :requires option. </div></td></tr></tbody></table></div><div class="artifact" id="cjd-gen"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L541">cjd-gen</a></td><td align="right"><a href="cjd.util.defnk.html#defnk">defnk</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">cjd&#8209;gen</span> [sources out&#8209;dir :exclude nil :requires nil :add&#8209;css nil :use&#8209;css nil :title nil :overview nil :throw&#8209;on&#8209;warn false :nogen false :v #{:f :n} :theme :light :header nil :footer nil :noindex false :index nil :filter nil :docstrings false :all false :showopts false])</span></p><div class="desc"><p><a href="cjd.util.defnk.html#defnk">defnk</a>-based alternate front-end for <a href="#cjd-generator">cjd-generator</a>, intended for easy REPL invocation. </p><p>Arguments and results are as described in <a href="#cjd-generator">cjd-generator</a>, except that options can be specified as keyword-value argument pairs.</p></div></div><div class="artifact" id="cjd-generator"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L350">cjd-generator</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">cjd&#8209;generator</span> [<span class="n1">sources</span> <span class="n1">out&#8209;dir</span> <span class="n1">options</span>])</span></p><div class="desc"><p>Main CJD document processing driver. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">sources</span> &mdash; A file or directory name (string), or collection of files or directory names, that are searched or examined for candidate clojure (&quot;.clj&quot;) files to be included in the documentation generation process. </p><p class="a1"><span class="n1">out&#8209;dir</span> &mdash; The name (string) of the top-level directory where generated documentation files are to be placed. </p><p class="a1"><span class="n1">options</span> &mdash; A map describing options for <span class="n0">cjd-generator</span>. </p><div class="s"><p class="a"><span class="n2">:exclude</span> &mdash; A specification, or collection of specifications, for files to be excluded from those implied by <span class="n1">sources</span>. This is a collection of objects which are either </p><ul><li><p>A string representing a prefix of file names to be excluded. </p></li><li><p>A regex pattern.</p></li></ul><p>If a path name starts with any of the strings, or matches any of the patterns, it is excluded. As a convenience, path separator characters are all translated to &quot;/&quot; before making the comparison. <i>Sic semper fenestrae!</i></p><p class="a"><span class="n2">:requires</span> &mdash; The name (symbol or string) of a namespace, or a collection of namespace names, to be added to the base state of affairs during comment processing. This supports extensions for such purposes as added artifacts or alternative generation methods. Namespaces can be specified as symbols or strings. </p><p class="a"><span class="n2">:use&#8209;css</span> &mdash; String, or a collection of strings, representing URI(s) of CSS document(s) to use. These URIs <i>replace</i> the standard CSS documents. </p><p class="a"><span class="n2">:add&#8209;css</span> &mdash; String, or a collection of strings, representing URI(s) of CSS document(s) to add. These URIs are <i>added to</i> the standard CSS documents, or those specified by the <span class="n2">:use-css</span> option. </p><p class="a"><span class="n2">:title</span> &mdash; A title for the body of documentation. This will appear in the document title of all generated pages. </p><p class="a"><span class="n2">:overview</span> &mdash; The name of a .clj file containing a CJD-comment that notionally describes the overall body of work being documented by the <span class="n0">cjd-generator</span> run. The overview text is taken from the first CJD-doc comment in the file. </p><p>As a suggestion, note that a leiningen &quot;project.clj&quot; file works excellently for this purpose!</p><p class="a"><span class="n2">:index</span> (default: <span class="expr">"index.html"</span>) &mdash; The name of the index file to generate, relative to the directory specified by <span class="n1">out-dir</span>. </p><p class="a"><span class="n2">:noindex</span> (default: <span class="expr">false</span>) &mdash; Suppresses index generation. </p><p class="a"><span class="n2">:throw&#8209;on&#8209;warn</span> (default: <span class="expr">false</span>) &mdash; If true, warnings throw exceptions instead of just printing a warning message. </p><p class="a"><span class="n2">:nogen</span> (default: <span class="expr">false</span>) &mdash; Intended as a development tool. When true, suppresses the HTML generation phase, and causes <span class="n0">cjd-generator</span> to return the the results of the pre-HTML-generation phase of the operation. </p><p class="a"><span class="n2">:all</span> (default: <span class="expr">false</span>) &mdash; If true, adds all recognized artifacts to the generated output, not just those with CJD comments. </p><p class="a"><span class="n2">:docstrings</span> (default: <span class="expr">false</span>) &mdash; If true, adds any artifact with a docstring to the generated output, and uses the artifact's docstring as documentation if it has no CJD comment. </p><p class="a"><span class="n2">:v</span> (default: <span class="expr">#{:f :n}</span>) &mdash; A collection (coerced to a set) of keys describing the desired level of output. Keys can be any of: </p><div class="s"><p class="a"><span class="n3">:f</span> &mdash; produces a message when starting the processing of a file. </p><p class="a"><span class="n3">:e</span> &mdash; produces a message when an artifact has been parsed. </p><p class="a"><span class="n3">:n</span> &mdash; produces a message when HTML generation starts for a new namespace. </p><p class="a"><span class="n3">:a</span> &mdash; produces a message when generation starts for a new artifact.</p></div><p class="a"><span class="n2">:theme</span> &mdash; If non-nil, selects a style theme, as defined by a set of CSS files. Standard options include: </p><div class="s"><p class="a"><span class="n3">:light</span> &mdash; Generates light-field (white background) pages (the default). </p><p class="a"><span class="n3">:dark</span> &mdash; Generates dark-field (black background) pages.</p></div><p>Note that <span class="n2">:theme</span> is not meaningful if the <span class="nx">:css</span> option is specified.</p><p class="a"><span class="n2">:footer</span> &mdash; Either a function, or a symbol that resolves to a function, that generates a footer used on each generated web page. The function has the form <code>(<span class="fn">fn</span> [<span class="n3">context</span>])</code>, where </p><div class="s"><p class="a"><span class="n3">context</span> &mdash; The current <a href="cjd.context.html#Context">Context</a> object. </p></div><div class="s"><p class="a"><span class="k">Returns</span> &mdash; A string containing HTML to be inserted as the footer.</p></div><p class="a"><span class="n2">:header</span> &mdash; Either a function, or a symbol that resolves to a function, that generates a header used on each generated web page. The function has the form <code>(<span class="fn">fn</span> [<span class="n3">context</span>])</code>, where </p><div class="s"><p class="a"><span class="n3">context</span> &mdash; The current <a href="cjd.context.html#Context">Context</a> object. </p></div><div class="s"><p class="a"><span class="k">Returns</span> &mdash; A string containing HTML to be inserted as the header.</p></div><p class="a"><span class="n2">:filter</span> &mdash; A function, or a symbol that resolves to a function, that selects artifacts to include in the output. This function has the form <code>(<span class="fn">fn</span> [<span class="n3">artifact</span>])</code>, where: </p><div class="s"><p class="a"><span class="n3">artifact</span> &mdash; The artifact to evaluate. </p></div><div class="s"><p class="a"><span class="k">Returns</span> &mdash; True, if the artifact designated by <span class="n3">artifact</span> should be included in the output.</p></div></div></div><div><p class="i1"><span class="k1">Returns</span></p><p>nil, unless the <span class="n2">:nogen</span> option is set, in which case it returns results of the early phases of operation. </p><p>In the latter case, the result has the form <code>[<span class="n2">ns&#8209;artifacts</span> <span class="n2">base&#8209;context</span>]</code>, where </p><div class="s"><p class="a"><span class="n2">ns&#8209;artifacts</span> &mdash; The collection of all <a href="cjd.core-artifacts.html#Namespace">Namespace</a> artifacts gleaned from the source files. </p><p class="a"><span class="n2">base&#8209;context</span> &mdash; The context object as it stands at the start of the generation process.</p></div></div></div></div><div class="artifact" id="cjd-read"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L45">cjd-read</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">cjd&#8209;read</span> [<span class="n1">reader</span>])</span></p><p class="decl"><span class="expr">(<span class="n0">cjd&#8209;read</span> [<span class="n1">reader</span> <span class="n1">eof&#8209;error?</span> <span class="n1">eof&#8209;value</span>])</span></p><p class="decl"><span class="expr">(<span class="n0">cjd&#8209;read</span> [<span class="n1">reader</span> <span class="n1">eof&#8209;error?</span> <span class="n1">eof&#8209;value</span> <span class="n1">recursive?</span>])</span></p><div class="desc"><p>Reads the next form from the specified input reader. </p><p>This is essentially identical in behavior to <a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/read">read</a>, except that it uses the CJD reader.</p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">reader</span> &mdash; A <a href="http://download.oracle.com/javase/7/docs/api/java/io/Reader.html">Reader</a> object, which must also implement the <a href="http://download.oracle.com/javase/7/docs/api/java/io/PushbackReader.html">PushbackReader</a> interface. </p><p class="a1"><span class="n1">eof&#8209;error?</span> &mdash; <code>true</code>, if end of file is to be considered as an error. If true and a read is attempted past EOF, an exception is thrown. Defaults value is false. </p><p class="a1"><span class="n1">eof&#8209;value</span> &mdash; A value to be returned if end-of-file is encountered. Only meaningful if <span class="n1">eof-error?</span> is <code>false</code>. </p><p class="a1"><span class="n1">recursive?</span> &mdash; True, if... </p></div><div><p class="i1"><span class="k1">Returns</span></p><p>The next form from the reader.</p></div></div></div><div class="artifact" id="endoculate"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L129">endoculate</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">endoculate</span> [<span class="n1">context</span> <span class="n1">filename</span> <span class="n1">forms</span>])</span></p><div class="desc"><p>Accepts a sequence of Clojure forms from some source, and motivates a parsing exercise on them, to result in a rough abstract syntax tree that serves as the basis for further processing. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">context</span> &mdash; The current context object. </p><p class="a1"><span class="n1">filename</span> &mdash; The source-directory-relative path name of the source file. </p><p class="a1"><span class="n1">forms</span> &mdash; A sequence of forms as generated, e.g. by <a href="#forms-from-file">forms-from-file</a>. </p></div><div><p class="i1"><span class="k1">Returns</span></p><p>A tuple of the form <code>[<span class="n2">ns&#8209;obj</span> <span class="n2">artifacts</span>]</code>, where </p><div class="s"><p class="a"><span class="n2">ns&#8209;obj</span> &mdash; The namespace artifact from the source, if there was one. </p><p class="a"><span class="n2">artifacts</span> &mdash; A sequence of artifact objects from the source.</p></div></div></div></div><div class="artifact" id="excluded-file"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L165">excluded-file</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">excluded&#8209;file</span> [<span class="n1">file</span> <span class="n1">exclusions</span>])</span></p><div class="desc"><p>Determines if a file should be excluded from processing. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">file</span> &mdash; A <a href="http://download.oracle.com/javase/7/docs/api/java/io/File.html">File</a> object representing the file to be checked. Note that as a mindless convenience, the file's path name separator characters are all translated into slashes &quot;/&quot;. </p><p class="a1"><span class="n1">exclusions</span> &mdash; A collection of objects which are either </p><ul><li><p>A string representing the prefix of file names to be excluded. </p></li><li><p>A regex pattern.</p></li></ul><p>If <span class="n1">file</span>'s path name starts with any of the strings, or matches any of the patterns, it is excluded.</p></div><div><p class="i1"><span class="k1">Returns</span></p><p>Truth if the file should be excluded.</p></div></div></div><div class="artifact" id="find-files"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L190">find-files</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">find&#8209;files</span> [<span class="n1">file&#8209;set</span> <span class="n1">files</span> <span class="n1">exclusions</span>])</span></p><div class="desc"><p>Starting from a collection of file objects, checks to see if each file is directly of interest (e.g., is readable, ends with &quot;.clj&quot;, isn't excluded), or if it's a directory, in which case its contents are recursively analyzed. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">file&#8209;set</span> &mdash; The set of <a href="http://download.oracle.com/javase/7/docs/api/java/io/File.html">File</a> objects that have been accumulated to date. <span class="n0">find-files</span> adds to this set. </p><p class="a1"><span class="n1">files</span> &mdash; A collection of <a href="http://download.oracle.com/javase/7/docs/api/java/io/File.html">File</a> objects to be examined for inclusion. </p><p class="a1"><span class="n1">exclusions</span> &mdash; A set of exclusion criteria </p></div><div><p class="i1"><span class="k1">Returns</span></p><p><span class="n1">file-set</span>, augmented with any files discovered locally.</p></div></div></div><div class="artifact" id="find-item"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L217">find-item</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">find&#8209;item</span> [<span class="n1">designator</span> <span class="n1">what</span>])</span></p><div class="desc"><p>Tries to find an item (such as a function) that's identified in any of several ways. </p><p><span class="n1">designator</span> designates the the item, and can be any of: </p><ul><li><p>A symbol that names an item. In this case, <span class="n0">find-item</span> resolves the name and retrieves and returns the resulting object. </p></li><li><p>A string containing the name of an item. <span class="n0">find-item</span> processes this as above. </p></li><li><p><span class="n0">find-item</span> presumes that anything else is item of interest, in which case it returns <span class="n1">designator</span> as-is.</p></li></ul><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">designator</span> &mdash; The object that designates the item. </p><p class="a1"><span class="n1">what</span> &mdash; A string identifying the item's intended use, for use in generating an error message. </p></div><div><p class="i1"><span class="k1">Returns</span></p><p>The resolved item.</p></div></div></div><div class="artifact" id="forms-from-file"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L83">forms-from-file</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">forms&#8209;from&#8209;file</span> [<span class="n1">file&#8209;or&#8209;name</span>])</span></p><div class="desc"><p>Repetitively reads a Clojure file using <a href="#cjd-read">cjd-read</a>, and returns a sequence of the forms contained therein. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">file&#8209;or&#8209;name</span> &mdash; Identifies the file to extract forms from. Must be either a string containing the file name, or <a href="http://download.oracle.com/javase/7/docs/api/java/io/File.html">File</a> object. </p></div><div><p class="i1"><span class="k1">Returns</span></p><p>A sequence of forms read from the file.</p></div></div></div><div class="artifact" id="forms-from-string"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L105">forms-from-string</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">forms&#8209;from&#8209;string</span> [<span class="n1">string</span>])</span></p><div class="desc"><p>Repetitively reads from a string using <a href="#cjd-read">cjd-read</a>, and returns a sequence of the forms contained therein. This is intended primarily as a debugging tool. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">string</span> &mdash; The string to read forms from. </p></div><div><p class="i1"><span class="k1">Returns</span></p><p>A sequence of forms read from the string.</p></div></div></div><div class="artifact" id="massage"><table class="topline"><tbody><tr><td><a class="itemname" href="https://github.com/greenh/CJD/blob/master/src/clojure/cjd/exome.clj#L236">massage</a></td><td align="right"><a href="http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/defn">defn</a> in <a href="#top">cjd.exome</a></td></tr></tbody></table><p class="decl"><span class="expr">(<span class="n0">massage</span> [stuff])</span></p><div class="desc"><p>&quot;Massages&quot; identifiers for things like the :requires option. </p><div class="s1"><p class="v1"><span class="k1">Arguments</span></p><p class="a1"><span class="n1">An</span> &mdash; identifier, quoted or not, or a list of identifiers, quoted or not. </p></div><div><p class="i1"><span class="k1">Returns</span></p><p>A collection of unquoted idenfitiers.</p></div></div></div><div class="trailer"><span class="ending">Generated by <a href="https://github.com/greenh/CJD">CJD</a> 0.1.0 under Clojure 1.4.0  on 10 December 2012 20:14 PST</span></div><div style="margin-top: 1mm; margin-bottom: 4mm; text-align: center; width: 100%;"><span style="font-size: 8pt;">Copyright &copy; 2012 Howard Green. All rights reserved.</span></div></body></html>